var e={307:(e,r,t)=>{t.d(r,{P2:()=>c,ZZ:()=>a});const n="ReplayDB",o=3,a={replays:"Replays",lists:"ReplayLists",meta:"ReplayMeta",config:"Config",directoryHandles:"DirectoryHandles"};let s=null;function c(){return new Promise((e,r)=>{if(s)return void e(s);const t=indexedDB.open(n,o);t.onupgradeneeded=e=>{const r=e.target.result,t=e.target.transaction;for(let n=e.oldVersion;n<o;n++){const e=l[n];e?.schema&&e.schema(r,t)}},t.onsuccess=()=>{s=t.result,e(s)},t.onerror=()=>r(t.error)})}const i={schema:(e,r)=>{const t=e.objectStoreNames.contains(a.replays)?r.objectStore(a.replays):e.createObjectStore(a.replays,{keyPath:"replayHash"});t.indexNames.contains("gametime")||t.createIndex("gametime","gametime",{unique:!1});const n=e.objectStoreNames.contains(a.lists)?r.objectStore(a.lists):e.createObjectStore(a.lists,{keyPath:"replayHash"});if(n.indexNames.contains("gametime")||n.createIndex("gametime","gametime",{unique:!1}),n.indexNames.contains("gameMode")||n.createIndex("gameMode","gameMode",{unique:!1}),n.indexNames.contains("playerNames")||n.createIndex("playerNames","playerNames",{multiEntry:!0}),n.indexNames.contains("commandersTeam1")||n.createIndex("commandersTeam1","commandersTeam1",{multiEntry:!0}),n.indexNames.contains("commandersTeam2")||n.createIndex("commandersTeam2","commandersTeam2",{multiEntry:!0}),!e.objectStoreNames.contains(a.meta)){const r=e.createObjectStore(a.meta,{keyPath:"replayHash"});r.createIndex("uploaded","uploaded",{unique:!1}),r.createIndex("filePath","filePath",{unique:!1}),r.createIndex("skip","skip",{unique:!1})}e.objectStoreNames.contains(a.config)||e.createObjectStore(a.config)}},d={schema:(e,r)=>{e.objectStoreNames.contains(a.directoryHandles)||e.createObjectStore(a.directoryHandles)}},l={0:i,1:{data:e=>{const r=e.stores[a.meta];if(r)for(const e of r)"boolean"==typeof e.uploaded&&(e.uploaded=e.uploaded?1:0);const t=e.stores[a.lists];if(t)for(const e of t)e.playerNames||(e.playerNames=[]);return e.__meta.dbVersion=2,e}},2:d}}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return e[n](a,a.exports,t),a.exports}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var n={};t.d(n,{LB:()=>a,SO:()=>c,Wm:()=>s,Xg:()=>i,sf:()=>d,xV:()=>l});var o=t(307);async function a(e,r){const t=await(0,o.P2)();return new Promise((n,a)=>{const s=t.transaction(o.ZZ.directoryHandles,"readwrite").objectStore(o.ZZ.directoryHandles).put(r,e);s.onsuccess=()=>n(),s.onerror=()=>a(s.error)})}async function s(e){const r=await(0,o.P2)();return new Promise(t=>{const n=r.transaction(o.ZZ.directoryHandles,"readonly").objectStore(o.ZZ.directoryHandles).get(e);n.onsuccess=()=>t(n.result??null),n.onerror=()=>t(null)})}async function c(){const e=await(0,o.P2)();return new Promise(r=>{const t=e.transaction(o.ZZ.directoryHandles,"readonly").objectStore(o.ZZ.directoryHandles).getAllKeys();t.onsuccess=()=>r(t.result),t.onerror=()=>r([])})}async function i(e){const r=await(0,o.P2)();return new Promise((t,n)=>{const a=r.transaction(o.ZZ.directoryHandles,"readwrite");a.objectStore(o.ZZ.directoryHandles).delete(e),a.oncomplete=()=>t(!0),a.onerror=()=>n(a.error)})}async function d(e,r="read"){if(!e)return!1;const t={mode:r};if("granted"===await(e.queryPermission?.(t)))return!0;return"granted"===await(e.requestPermission?.(t))}async function l(){if(!("showDirectoryPicker"in window))return console.warn("showDirectoryPicker is not supported in this browser."),null;try{return await window.showDirectoryPicker()}catch(e){return"AbortError"===e.name||console.error("Error picking directory:",e),null}}const m=n.Xg,u=n.SO,y=n.Wm,p=n.xV,f=n.LB,g=n.sf;export{m as deleteDirectoryHandle,u as getAllDirectoryHandles,y as getDirectoryHandle,p as getDirectoryHandleFromUser,f as saveDirectoryHandle,g as verifyDirectoryPermission};